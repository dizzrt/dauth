syntax = "proto3";

package client;
option go_package = "github.com/dizzrt/dauth/api/gen/client;client";

import "base/base.proto";
import "client/client_common.proto";
import "google/api/annotations.proto";

message CreateClientRequest {
    string name = 1;
    string description = 2;
    string secret = 3;
    string redirect_uri = 4;
    repeated uint32 scopes = 5;

    base.Base base = 255;
}

message CreateClientResponse {
    uint32 client_id = 1;

    base.BaseResp base_resp = 255;
}

message GetClientRequest {
    uint32 client_id = 1;

    base.Base base = 255;
}

message GetClientResponse {
    Client client = 1;

    base.BaseResp base_resp = 255;
}

message ValidateClientRequest {
    uint32 client_id = 1;
    string scope = 2;

    base.Base base = 255;
}

message ValidateClientResponse {
    bool is_ok = 1;
    string reason = 2;

    base.BaseResp base_resp = 255;
}


service ClientService {
    // CreateClient creates a new client.
    rpc CreateClient(CreateClientRequest) returns (CreateClientResponse) {
        option (google.api.http) = {
            post: "/client/client/create"
            body: "*"
        };
    }

    rpc GetClient(GetClientRequest) returns (GetClientResponse) {}

    // ValidateClient validates the client and scope.
    rpc ValidateClient(ValidateClientRequest) returns (ValidateClientResponse) {}
}